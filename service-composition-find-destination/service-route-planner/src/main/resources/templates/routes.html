<!DOCTYPE html>
<html lang="en">
<head>
    <title>Add Map</title>
    <script>(g => {
        let h, a, k, p = "The Google Maps JavaScript API", c = "google", l = "importLibrary", q = "__ib__",
            m = document,
            b = window;
        b = b[c] || (b[c] = {});
        const d = b.maps || (b.maps = {}), r = new Set, e = new URLSearchParams,
            u = () => h || (h = new Promise(async (f, n) => {
                await (a = m.createElement("script"));
                e.set("libraries", [...r] + "");
                for (k in g) e.set(k.replace(/[A-Z]/g, t => "_" + t[0].toLowerCase()), g[k]);
                e.set("callback", c + ".maps." + q);
                a.src = `https://maps.${c}apis.com/maps/api/js?` + e;
                d[q] = f;
                a.onerror = () => h = n(Error(p + " could not load."));
                a.nonce = m.querySelector("script[nonce]")?.nonce || "";
                m.head.append(a)
            }));
        d[l] ? console.warn(p + " only loads once. Ignoring:", g) : d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n))
    })
    ({key: "AIzaSyDxS3k5ix72NvCWTjYVj5wnQCdJ3Y3O4no", v: "weekly"});</script>
<!--    <script type="module" th:src="@{/script/initializeMap.js}"></script>-->
    <script>
        async function initMap(source, destination) {
            console.log(source, destination)
            const {Map} = await google.maps.importLibrary("maps");
            var myLatLang = {"lat": 52.21833, "lng": 6.89583}
            var options = {
                center: myLatLang,
                zoom: 7,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(document.getElementById("map"), options);


            var directionsService = new google.maps.DirectionsService();
            var directionsDisplay = new google.maps.DirectionsRenderer();
            directionsDisplay.setMap(map);
        }
    </script>
    <link rel="stylesheet" type="text/css" th:src="@{/css/style.css}"/>

</head>
<style>
    #map {
        width: 80%;
        height: 400px;
        margin: 20px auto;
    }
</style>
<body>

<h3>My Google Maps Demo</h3>
<!--The div element for the map -->
<div id="map" th:attr="onload|@{'initMap(' + ${source} + ',' + ${destination} + ')'}|"></div>

</body>
</html>